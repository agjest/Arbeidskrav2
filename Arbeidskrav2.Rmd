---
title: 'Arbeidskrav 2'
output:
  html_document:
    df_print: paged
    toc: true
  pdf_document:
    toc: true 
  word_document:
    toc: true 
lang: nb-NO
bibliography: 
csl: apa-no-ampersand.csl
---
```{r}
options(scipen = 999)

```

## Innledning

I arbeidslivet er det mange faktorer som påvirker årslønnen til den ansatte. Ved hjelp av datasettet "heights" skal vi i denne oppgaven undersøke om det er høyde som ene og alene har påvirkning for inntjening av lønn. Samtidig skal vi undersøke om andre variabler som alder, utdanning og sivilstatus og kjønn også påvirker årslønnen til den ansatte og måle disse variablene opp mot høyde. Vi har valgt å avgrense datasettet til de personene som har positiv inntekt (5266 av 7006 deltakende i datsettet). Grunnet stort utvalg av respondenter til dette datasettet, bør disse dataene være troverdig iforhold til realiteten


I datasettet ser vi tydelig at de personene som er høyere tjener bedre enn de som er lavere. Ved hjelp av oppgavesettet skal vi gjennomføre ulike plot både på envariabel analyse for å kartlegge inntekten i forhold til høyden, samt på tovariabel analyse for å finne ut om det faktisk er høyde som utgjør inntektsforskjellen på de ansatte eller om det er andre faktorer som utgjør at lønnen er høyere til de høye personene. 


## Statistikk

```{r}
library(modelr)
?modelr::heights
x <- modelr::heights
attach(x)
heights$heightInt <- cut(heights$height, breaks = 8)
knitr::kable(summary(heights[,4:9]))
knitr::kable(summary(heights[,5:9]))

``` 

## Deskriptiv statistikk høyde, vekt og alder.

```{r}
knitr::kable(summary(heights[2]))
```
Ved hjelp av denne datakoden får vi opp den deskriptive statistikken for høyde i datasettet heights. Gjennomsnittet for dette utvalget på 7006 personer er 67,1 inches eller 170,434 cm.

```{r}
knitr::kable(summary(heights[2:4]))
```
Ved å legge til "2:4" får vi opp den deskriptive statistikken for variabel 2 til 4, det vil si både høyde, vekt og alder. Ut ifra tallene for alder ser vi at de som er inkludert i dette datasettet er personer mellom 47 og 56 år og gjennomsnittet for disse er 51,33 år. Det vil si at de fleste som er deltakende i datasettet er personer som er ferdig med utdanning. Nedenfor ser vi at gjennomsnittet for antall år utdanning er rett i overkant av 13 år.

```{r}
knitr::kable(summary(heights[7]))
```


# Analyse og plots

I oppgave 1 skal vi foreta èn variabel analyse. Da har vi valgt å kikke på variablene høyde og inntekt hver for seg på grunn av dette var mest relevant for oppgaven. For disse 2 variablene skal vi lage et histogram, et density plot og et boxplot for å se om observasjonene er normalfordelte eller ikke.


```{r echo=TRUE}
#install.packages("ggplot2")

library("ggplot2")
ggplot(heights, mapping = aes(x = height, y = income))+geom_point()

```

```{r}
hist(heightsPosInc$height, main = "Histogram høyde", xlab = "inches", ylab = "antall", col = "darkseagreen4")
```

Ved å lage et histogram av høyde ser vi at observasjonene i datasettet "heightsPosInc" er normalfordelte.

heights$NOK <- income * 10

heights$cm <- height * 2,54



```{r}
hist(heightsPosInc$NOK, main = "Histogram Inntekt", xlab = "NOK", ylab = "antall", col = "darkseagreen4")
```

Det er motsatt tilfelle for histogram for inntekt. Her er fordelingen ikke normalfordelt og i dette tilfellet vil vi forsøke å gjennomføre en transformasjon. 

```{r}
heightsPosInc$logincome <- log(heightsPosInc$income)
hist(heightsPosInc$logincome, main = "Histogram transformert inntekt (log inntekt)", xlab = "Log Income", ylab = "Antall")
```
I eksempelet ovenfor har vi foretatt en transformasjon og grafen er nå blitt tilnærmet normalfordelt, men ytterst til høyre har vi en outlayer.

```{r}
plot(density(heightsPosInc$height), main = "Density plot høyde", xlab = "NOK", ylab = "andel")
```
I likhet med histogram for høyde så gir også density plot for høyde et bilde av at grafen er normalfordelt. Det vil si at flesteparten av observasjonene er sentrert rundt 65-70 inches.

```{r}
plot(density(heightsPosInc$income), main = "Density plot inntekt", xlab = "inntekt", ylab = "Andel", col = "green4")
```

I likhet med histogram for inntekt så gir også density plot for inntekt et bilde av grafen ikke er normalfordelt. Vi vurderer også i dette tilfellet slik at en transformasjon er på plass.

logincome rm(kg)

```{r}
plot(density(heightsPosInc$logincome), main = "Density plot transformert inntekt (log inntekt)", xlab = "loginntekt", ylab = "Andel", col = "green4")

```
I eksempelet ovenfor har vi foretatt en transformasjon og grafen er nå blitt tilnærmet normalfordelt, men ytterst til høyre har vi en outlayer.

```{r}
heights_under1000000 <- heights %>%
  filter(income < 100000)
```


```{r}
heightsPosInc <-subset(heights, income>0)
ggplot(heights_under1000000, mapping =aes(x = heightInt, y = income, fill= heightInt))+
geom_boxplot(col = "darkseagreen4")
```
På boxplot har vi tatt høydeintervall i forhold til inntekt. Vi har valgt å avgrense inntekten til maksimalt kr. 1 000 000 på dette plotet for å unngå outlayers som gjør at grafen blir mindre oversiktlig. 

```{r echo=TRUE}
#install.packages("ggplot2")
library("ggplot2")
ggplot(heights, mapping = aes(x = height, y = income))+
geom_point(col = "darkseagreen4")

```

De svarte prikkene som er øverst på rekken i geom_point plottet er outlayers. Det vil si at disse observasjonene skiller seg veldig i fra de observasjonene som er normalfordelte. Et eksempel på outlayers kan være når de fleste tjener mellom 400 000 og 800 000 NOK, men så er det noen som tjener over 2 millioner kroner. Dette er et typisk ekspemel på outlayers og på en graf så er det disse observasjonene som ligger lengst ifra de andre observasjonene, og i dette tilfellet øverst.

```{r}
summary(lm(income~height, data = heights))
```

# Våre funn vs tidligere forskning

# Konklusjon

Her er arbeidskrav 2. 


