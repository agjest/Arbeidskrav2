---
title: 'Arbeidskrav 2'
output:
  html_document:
    df_print: paged
    toc: true
  pdf_document:
    toc: true 
  word_document:
    toc: true 
lang: nb-NO
bibliography: 
csl: apa-no-ampersand.csl
---
 

# Innledning

# Statistikk

```{r}
library(modelr)
?modelr::heights
x <- modelr::heights
attach(x)
heights$heightInt <- cut(heights$height, breaks = 8)
knitr::kable(summary(heights[,4:9]))
knitr::kable(summary(heights[,5:9]))
knitr::kable(summary(heights[,2]))

``` 


# Analyse og plots

```{r echo=TRUE}
#install.packages("ggplot2")
library("ggplot2")
ggplot(heights, mapping = aes(x = height, y = income))+geom_point(colour = "darkseagreen4")

```


```{r}
heightsPosInc <- subset(heights, income>0)
ggplot(heightsPosInc, mapping = aes(x = heightInt, y = income)) +
  scale_y_continuous(trans = scales::log_trans()) +
  geom_boxplot()
```

```{r}
heightsPosInc <- subset(heights, income>0)
ggplot(heightsPosInc, mapping = aes(x = height, y = income)) +
  scale_y_continuous(trans = scales::log_trans()) +
  geom_point(position = "jitter", colour = "darkseagreen4") +
  geom_smooth(method = "lm")
```

```{r}
heightsPosInc <- subset(heights, income>0)
ggplot(heightsPosInc, mapping = aes(x = height, y = income)) + 
  geom_point(position = "jitter", colour = "darkseagreen4") +
  geom_smooth(method = "lm") +
  geom_smooth(method = MASS::rlm, colour = "firebrick3", se = TRUE)
```


```{r}
summary(lm(income ~ height, data = heights))
```

Del 2) To variabler analyse: geom_point(), geom_jitter(), geom_smooth() etc., event. mer enn to variabler hvis det kan øke innsikten (bind til farge, form, størrelse eller alpha alt etter hva som har størst informasjonsverdi). Kan bruk av facets gi mer innsikt?



```{r}
ggplot() + geom_point(data = heightsPosInc, mapping = aes(x = height, y = income, colour = education, size = age, shape = sex)) +
  labs(colour = "Education", size = "Age", shape = "Sex") +
  geom_smooth(data = heightsPosInc, mapping = aes(x = height, y = income))
```

```{r}
ggplot() + geom_point(data = heightsPosInc, mapping = aes(x = height, y = income), colour = "darkseagreen4") +
  geom_smooth(data = heightsPosInc, mapping = aes(x = height, y = income)) + 
  theme_linedraw()
```

```{r}
plot1 <- ggplot(data = heights, mapping = aes(x = height, y = income, colour = sex)) +
  geom_point() +
  geom_smooth(method = "lm", se = TRUE)
plot1
```



```{r}
plot2 <- ggplot(data = heights, mapping = aes(x = height, y = income, colour = sex)) +
  geom_point() +
  geom_smooth(method = MASS::rlm, se = TRUE)
plot2
```

I plottet over ser vi et visuelt bilde av hvordan høyde kan være med på å forklare inntekt gitt om en er mann eller kvinne. Fargen rosa viser her til observasjonene av menn, mens de lyseblå er kvinner. Den rosa regresjonslinja er her regresjonslinjen for menn og den lyseblå for kvinner. Som man kan se er linja brattere for mennene enn kvinnene, noe som peker mot at høyden har mer å si for menn med tanke på inntekt enn for kvinner. I plot 2 er det også tatt høyde for ekstreme observasjoner for å kunne få en mer riktigere helning på kurven. 

Under følger en oversikt over begge plottene. 
```{r}
# install.packages("ggpubr")
library(ggpubr)
ggarrange(plot1, plot2, ncol = 2, nrow = 1, labels = c("Med ekstrempunkt", "Uten ekstrempunkt"))
```

Facetter:

Facetter kan uten tvil være nyttig for analyseformål og å gi oss mer innsikt om dataene vi har. 

Først følger en facet der vi også ser på utdanning. Jo lysere blåfarge, jo mer utdanning. Gir også oss den innsikt av at det ser ut som at det eksisterer en tendens for at de med lavere utdanning har lavere lønn. Samtidig er denne facet-bruken godt egnet for å sammenligne menn og kvinner. 

```{r}
ggplot(heightsPosInc, mapping = aes(x = height, y = income, colour = education)) + 
  geom_point(position = "jitter") +
  geom_smooth(method = MASS::rlm) +
  facet_grid(~ sex)
```
```{r}
ggplot(heightsPosInc, mapping = aes(x = height, y = income)) + 
  geom_point(position = "jitter", colour = "darkseagreen4") +
  geom_smooth(method = MASS::rlm, colour = "brown") +
  facet_grid(~ marital)
```
Over har vi istedenfor sett på om forskjeller i sivilstatus kan ha noe å si for forholdet mellom høyde og inntekt. Det later til å være slik. Ekstreme observasjoner er hensyntatt også her. Som man ser virker høyde å ha mer å si for inntekt dersom man er gift, i forhold til for eksempel noen som er single. 

Ny facet:

```{r}
heightsPosInc$educationNum <- as.numeric(heightsPosInc$education)
```


```{r}
heightsPosInc$educationInt <- cut(heightsPosInc$educationNum, breaks = 6)
```

```{r}
ggplot(heightsPosInc, mapping = aes(x = height, y = income)) + 
  geom_point(position = "jitter", colour = "darkseagreen4") +
  geom_smooth(method = MASS::rlm, colour = "brown") +
  facet_grid(~ educationInt)
```
Grafene ovenfor antyder at jo mer utdanning en har, jo mer virker det som at høyde har å si på inntekten. Gir ikke så veldig mye innsikt, den praktiske betydningen er usikker, men morsomt å ha med/undersøke likevel. 

```{r}
ggplot(data = heights, mapping = aes(x = height, y = income, colour = sex)) +
  geom_point() +
  geom_smooth(method = MASS::rlm, se = TRUE)
```

```{r}
heightsPosInc$logincome <- log(heightsPosInc$income)
hist(heightsPosInc$logincome, main = "Histogram Inntekt", xlab = "Log Income", ylab = "Antall")
```



# Våre funn vs tidligere forskning

# Konklusjon

Her er arbeidskrav 2. 



